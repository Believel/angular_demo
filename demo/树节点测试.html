<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>树节点测试</title>
</head>
<body>
<script src="../underscore.js"></script>
  <script>
    var oldObj = {
      "id": "1",
      "name": "熊大3211",
      "type": "Operation",
      "children": [
        {
          "id": null,
          "name": null,
          "type": "Step",
          "steptypeid": null,
          "steptypename": null,
          "children": [
            {
              "OperationStepId": null,
              "OperationFunctionId": null,
              "OperationFunctionName": null,
              "id": "cdd1b2d6-2d00-440b-9ddd-498097b30fd0",
              "name": null,
              "type": "Function",
              "children": [
                {
                  "id": "77678de3-4f29-426a-8b29-7c072a5e3ac9",
                  "functionid": null,
                  "name": null,
                  "type": "InputVariable"
                },
                {
                  "id": "7a96e9d8-e625-42ba-8540-ebebc2d9af8d",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                }
              ],
              "IsOpen": false
            }
          ],
          "IsOpen": false
        },
        {
          "id": "5b17adf4-9ec6-4a61-a38a-b6b5598b52fa",
          "name": null,
          "type": "Step",
          "steptypeid": null,
          "steptypename": null,
          "children": [
            {
              "OperationStepId": null,
              "OperationFunctionId": null,
              "OperationFunctionName": null,
              "id": null,
              "name": null,
              "type": "Function",
              "children": [
                {
                  "id": "231f9dec-bf40-4062-8b58-ee6b1c18c30e",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "d516894a-89e8-4a7a-a2f0-01462eb3f713",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "f40b47c5-f3ae-49ce-bf78-e2763817e0bd",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                }
              ],
              "IsOpen": false
            }
          ],
          "IsOpen": false
        },
        {
          "id": "6cb44636-eab2-4a77-8d78-93902ccb3c53",
          "name": null,
          "type": "Step",
          "steptypeid": null,
          "steptypename": null,
          "children": [
            {
              "OperationStepId": null,
              "OperationFunctionId": null,
              "OperationFunctionName": null,
              "id": null,
              "name": null,
              "type": "Function",
              "children": [
                {
                  "id": "231f9dec-bf40-4062-8b58-ee6b1c18c30e",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "d516894a-89e8-4a7a-a2f0-01462eb3f713",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "f40b47c5-f3ae-49ce-bf78-e2763817e0bd",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                }
              ],
              "IsOpen": false
            }
          ],
          "IsOpen": false
        },
        {
          "id": "a26710ad-2ce4-419c-82e3-6bbc3c9955df",
          "name": null,
          "type": "Step",
          "steptypeid": null,
          "steptypename": null,
          "children": [
            {
              "OperationStepId": null,
              "OperationFunctionId": null,
              "OperationFunctionName": null,
              "id": null,
              "name": null,
              "type": "Function",
              "children": [
                {
                  "id": "231f9dec-bf40-4062-8b58-ee6b1c18c30e",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "d516894a-89e8-4a7a-a2f0-01462eb3f713",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "f40b47c5-f3ae-49ce-bf78-e2763817e0bd",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                }
              ],
              "IsOpen": false
            }
          ],
          "IsOpen": false
        },
        {
          "id": "e9292431-2d79-4407-a71d-5ba25686991b",
          "name": null,
          "type": "Step",
          "steptypeid": null,
          "steptypename": null,
          "children": [
            {
              "OperationStepId": null,
              "OperationFunctionId": null,
              "OperationFunctionName": null,
              "id": null,
              "name": null,
              "type": "Function",
              "children": [
                {
                  "id": "231f9dec-bf40-4062-8b58-ee6b1c18c30e",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "d516894a-89e8-4a7a-a2f0-01462eb3f713",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "f40b47c5-f3ae-49ce-bf78-e2763817e0bd",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                }
              ],
              "IsOpen": false
            }
          ],
          "IsOpen": false
        },
        {
          "id": "f98cdb93-be5f-4feb-a8e0-9f8b9055941c",
          "name": null,
          "type": "Step",
          "steptypeid": null,
          "steptypename": null,
          "children": [
            {
              "OperationStepId": null,
              "OperationFunctionId": null,
              "OperationFunctionName": null,
              "id": null,
              "name": null,
              "type": "Function",
              "children": [
                {
                  "id": "231f9dec-bf40-4062-8b58-ee6b1c18c30e",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "d516894a-89e8-4a7a-a2f0-01462eb3f713",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                },
                {
                  "id": "f40b47c5-f3ae-49ce-bf78-e2763817e0bd",
                  "functionid": null,
                  "name": null,
                  "type": "OutputVariable"
                }
              ],
              "IsOpen": false
            }
          ],
          "IsOpen": false
        }
      ],
      "IsOpen": false
    };
    console.log(oldObj);
   var firstChildren = [],
      secondChildren = []
    if(oldObj.id === null) {
      oldObj = {};
    }
    for(var k in oldObj) {
      if(k === "children") {
         for(var i = 0; i< oldObj[k].length; i++){
            var cur = oldObj[k][i];
            if(cur.id !== null){
              firstChildren.push(cur);
            }
         }//for

         for(var k=0; k< firstChildren.length; k++){
            // console.log(firstChildren[k])
            var cur = firstChildren[k];//obj
            if(cur.children){
              for(var i =0; i< cur.children.length; i++){
                var cur1 = cur.children[i];
                if(cur1.id !== null){
                  secondChildren.push(cur1);
                }
              }
            }
            cur.children = secondChildren;
            // secondChildren = [];
         }//for

      }
    }//oldObj
 console.log(firstChildren);
  </script>
</body>
</html>
